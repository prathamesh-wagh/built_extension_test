var Built = require('built.io')
var base = require('../controller/base')
/**
 * This middleware wraps the the request body into js sdk wrappers
 */

module.exports = function (req, res, next) {
	var extensionsApp = this
	var secret_key    = req.headers.secret_key
	
	if(req.url.indexOf("/api") === 0 && (secret_key !== extensionsApp.getSecretKey())){
		return base.resError(req, res, {
			secret_key: "did not match. Please ensure the secret_key is rightly entered"
		})
	}
	next()
}